<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8" />
    <title>Kursy walut (ostatnie dni)</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style/styles.css') }}" />
</head>
<body>
    <h1>Kursy walut (ostatnie dni)</h1>

    {% if error %}
        <p style="color:red;">{{ error }}</p>
    {% endif %}

    <div class="form-container">
        <form method="get" action="/">
            <label for="currency">Wybierz walutę:</label>
            <select name="currency" id="currency">
                {% for key, name in currencies.items() %}
                    <option value="{{ key }}" {% if key == code %}selected{% endif %}>
                        {{ key }} - {{ name }}
                    </option>
                {% endfor %}
            </select>

            <label for="time">Wybierz zakres czasowy:</label>
            <select name="time" id="time">
                <option value="1" {% if request.args.get('time') == '1' %}selected{% endif %}>1 tydzień</option>
                <option value="2" {% if request.args.get('time') == '2' %}selected{% endif %}>2 tygodnie</option>
                <option value="3" {% if request.args.get('time') == '3' %}selected{% endif %}>3 tygodnie</option>
                <option value="4" {% if request.args.get('time') == '4' %}selected{% endif %}>4 tygodnie</option>
                <option value="5" {% if request.args.get('time') == '5' %}selected{% endif %}>5 tygodni</option>
                <option value="6" {% if request.args.get('time') == '6' %}selected{% endif %}>6 tygodni</option>
                <option value="7" {% if request.args.get('time') == '7' %}selected{% endif %}>7 tygodni</option>
                <option value="8" {% if request.args.get('time') == '8' %}selected{% endif %}>8 tygodni</option>
            </select>

            <button type="submit">Pokaż</button>
        </form>
    </div>

    <br />

    <table id="currency-table">
        <thead>
            <tr><th>Data</th><th>Kurs (PLN)</th></tr>
        </thead>
        <tbody>
            {{ tbody_html | safe }}
        </tbody>
    </table>

    <a href="{{ url_for('download_excel') }}?currency={{ code }}&time={{ request.args.get('time', 1) }}">
        <button>Pobierz dane (Excel)</button>
    </a>

    {% if chart_img %}
        <h2>Wykres</h2>
        <img src="{{ url_for('static', filename=chart_img) }}" alt="Wykres {{ code }}" style="max-width: 800px;">

        <br />
        <a href="{{ url_for('download_chart') }}?currency={{ code }}&time={{ request.args.get('time', 1) }}">
            <button>Pobierz wykres (PNG)</button>
        </a>
    {% endif %}
</body>
</html>
